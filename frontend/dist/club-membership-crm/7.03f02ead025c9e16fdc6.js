(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{XKfY:function(e,t,n){"use strict";n.r(t),n.d(t,"MembersModule",function(){return le});var c=n("ofXK"),o=n("tyNb"),r=n("M9IT"),i=n("Dh3D"),a=n("2Vo4");class m{constructor(e){this.com=e,this._size=20,this._offset=0,this.membersSubject=new a.a([]),this.loadingSubject=new a.a(!1),this.loading$=this.loadingSubject.asObservable()}set size(e){this._size=e}set offset(e){this._offset=e}connect(e){return this.membersSubject.asObservable()}disconnect(e){this.membersSubject.complete(),this.loadingSubject.complete()}loadMembers(e="",t="asc",n=0,c=20){this.loadingSubject.next(!0),this.com.getMembers(c,e,n*c).subscribe(e=>{this.membersSubject.next(e)})}}var s=n("vGmI"),b=n("fXoL"),l=n("0IaG"),u=n("XgXc"),d=n("+0xr"),f=n("XiUz"),h=n("bTqV"),p=n("NFeN");function g(e,t){1&e&&(b.Tb(0,"th",20),b.Ec(1," First Name"),b.Sb())}function C(e,t){if(1&e){const e=b.Ub();b.Tb(0,"td",21),b.bc("click",function(){b.xc(e);const n=t.$implicit;return b.fc().openProfile(n)}),b.Ec(1),b.Sb()}if(2&e){const e=t.$implicit;b.Cb(1),b.Gc(" ",e.firstName," ")}}function M(e,t){1&e&&(b.Tb(0,"th",20),b.Ec(1," Last Name"),b.Sb())}function S(e,t){if(1&e){const e=b.Ub();b.Tb(0,"td",21),b.bc("click",function(){b.xc(e);const n=t.$implicit;return b.fc().openProfile(n)}),b.Ec(1),b.Sb()}if(2&e){const e=t.$implicit;b.Cb(1),b.Gc(" ",e.lastName," ")}}function O(e,t){1&e&&(b.Tb(0,"th",20),b.Ec(1," Phone"),b.Sb())}function y(e,t){if(1&e){const e=b.Ub();b.Tb(0,"td",21),b.bc("click",function(){b.xc(e);const n=t.$implicit;return b.fc().openProfile(n)}),b.Ec(1),b.Sb()}if(2&e){const e=t.$implicit;b.Cb(1),b.Gc(" ",e.phoneNumber," ")}}function v(e,t){1&e&&(b.Tb(0,"th",20),b.Ec(1," Email"),b.Sb())}function P(e,t){if(1&e){const e=b.Ub();b.Tb(0,"td",21),b.bc("click",function(){b.xc(e);const n=t.$implicit;return b.fc().openProfile(n)}),b.Ec(1),b.Sb()}if(2&e){const e=t.$implicit;b.Cb(1),b.Gc(" ",e.email," ")}}function x(e,t){1&e&&(b.Tb(0,"th",20),b.Ec(1," Gender"),b.Sb())}function T(e,t){if(1&e){const e=b.Ub();b.Tb(0,"td",21),b.bc("click",function(){b.xc(e);const n=t.$implicit;return b.fc().openProfile(n)}),b.Ec(1),b.Sb()}if(2&e){const e=t.$implicit;b.Cb(1),b.Gc(" ",e.gender," ")}}function _(e,t){1&e&&b.Ob(0,"th",22)}function w(e,t){1&e&&(b.Tb(0,"td",23),b.Tb(1,"mat-icon"),b.Ec(2,"edit"),b.Sb(),b.Sb())}function F(e,t){1&e&&b.Ob(0,"th",22)}function N(e,t){1&e&&(b.Tb(0,"td",24),b.Tb(1,"mat-icon"),b.Ec(2,"delete"),b.Sb(),b.Sb())}function D(e,t){1&e&&b.Ob(0,"tr",25)}function E(e,t){1&e&&b.Ob(0,"tr",26)}function k(e,t){1&e&&(b.Tb(0,"tr",27),b.Tb(1,"td",28),b.Ec(2,"No data"),b.Sb(),b.Sb())}const I=function(){return[5,10,25,100]};let z=(()=>{class e{constructor(e,t,n){this.dialog=e,this.memberService=t,this.router=n,this.displayedColumns=["firstName","lastName","email","phoneNumber","gender","edit","delete"]}ngAfterViewInit(){}ngOnInit(){this.dataSource=new m(this.memberService),this.dataSource.loadMembers()}addMember(){this.dialog.open(s.a,{data:{id:0,firstName:"",lastName:"",email:"",gender:"Male",phoneNumber:""}}).afterClosed().subscribe(e=>{e&&this.memberService.newMember(e).toPromise().then(e=>{const t=this.dataSource.membersSubject;t.next([...t.getValue(),e])})})}openProfile(e){this.router.navigateByUrl("/members/"+e.id)}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(l.b),b.Nb(u.a),b.Nb(o.c))},e.\u0275cmp=b.Hb({type:e,selectors:[["app-members"]],viewQuery:function(e,t){if(1&e&&(b.Ic(r.a,1),b.Ic(i.a,1)),2&e){let e;b.tc(e=b.cc())&&(t.paginator=e.first),b.tc(e=b.cc())&&(t.sort=e.first)}},decls:32,vars:5,consts:[[1,"members-component"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","firstName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"click",4,"matCellDef"],["matColumnDef","lastName"],["matColumnDef","phoneNumber"],["matColumnDef","email"],["matColumnDef","gender"],["matColumnDef","edit"],["mat-header-cell","",4,"matHeaderCellDef"],["class","edit-cell","mat-cell","",4,"matCellDef"],["matColumnDef","delete"],["class","delete-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["fxLayoutAlign","end",1,"add-person-container"],["id","add-person-button","mat-fab","","color","primary",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"click"],["mat-header-cell",""],["mat-cell","",1,"edit-cell"],["mat-cell","",1,"delete-cell"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,t){1&e&&(b.Tb(0,"div",0),b.Tb(1,"div"),b.Tb(2,"table",1),b.Rb(3,2),b.Dc(4,g,2,0,"th",3),b.Dc(5,C,2,1,"td",4),b.Qb(),b.Rb(6,5),b.Dc(7,M,2,0,"th",3),b.Dc(8,S,2,1,"td",4),b.Qb(),b.Rb(9,6),b.Dc(10,O,2,0,"th",3),b.Dc(11,y,2,1,"td",4),b.Qb(),b.Rb(12,7),b.Dc(13,v,2,0,"th",3),b.Dc(14,P,2,1,"td",4),b.Qb(),b.Rb(15,8),b.Dc(16,x,2,0,"th",3),b.Dc(17,T,2,1,"td",4),b.Qb(),b.Rb(18,9),b.Dc(19,_,1,0,"th",10),b.Dc(20,w,3,0,"td",11),b.Qb(),b.Rb(21,12),b.Dc(22,F,1,0,"th",10),b.Dc(23,N,3,0,"td",13),b.Qb(),b.Dc(24,D,1,0,"tr",14),b.Dc(25,E,1,0,"tr",15),b.Dc(26,k,3,0,"tr",16),b.Sb(),b.Ob(27,"mat-paginator",17),b.Sb(),b.Tb(28,"div",18),b.Tb(29,"button",19),b.bc("click",function(){return t.addMember()}),b.Tb(30,"mat-icon"),b.Ec(31,"person_add"),b.Sb(),b.Sb(),b.Sb(),b.Sb()),2&e&&(b.Cb(2),b.mc("dataSource",t.dataSource),b.Cb(22),b.mc("matHeaderRowDef",t.displayedColumns),b.Cb(1),b.mc("matRowDefColumns",t.displayedColumns),b.Cb(2),b.mc("pageSizeOptions",b.oc(4,I)))},directives:[d.k,i.a,d.c,d.e,d.b,d.g,d.j,d.h,r.a,f.b,h.b,p.a,d.d,i.b,d.a,d.f,d.i],styles:[".members-component[_ngcontent-%COMP%]{position:relative}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%]:hover{background-color:#fff}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:rgba(0,117,169,.6);cursor:pointer}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   .mat-cell[_ngcontent-%COMP%]{color:#fff}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   .delete-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   .edit-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{visibility:visible}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .delete-cell[_ngcontent-%COMP%], .members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .edit-cell[_ngcontent-%COMP%]{width:70px}.members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .delete-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .members-component[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .edit-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{visibility:hidden}.members-component[_ngcontent-%COMP%]   .add-person-container[_ngcontent-%COMP%]{position:fixed;width:1150px;bottom:20px}"],changeDetection:0}),e})();var L=n("3Pt+"),j=n("wd/R"),A=n("LvDl"),R=n("kmnG"),$=n("qFsG"),G=n("QxcC");function U(e,t){if(1&e){const e=b.Ub();b.Rb(0),b.Tb(1,"div",2),b.Tb(2,"div",3),b.Tb(3,"div"),b.Ec(4),b.Sb(),b.Tb(5,"div",4),b.Ec(6),b.Sb(),b.Sb(),b.Tb(7,"button",5),b.Tb(8,"mat-icon",6),b.bc("click",function(){b.xc(e);const n=t.$implicit;return b.fc().removeFamilyMember(n)}),b.Ec(9,"remove"),b.Sb(),b.Sb(),b.Sb(),b.Qb()}if(2&e){const e=t.$implicit;b.Cb(4),b.Hc("",e.firstName," \xa0 ",e.lastName,""),b.Cb(2),b.Gc("mob: ",e.phoneNumber,"")}}let H=(()=>{class e{constructor(e){this.memberService=e,this.members=[],this.afterFamilyMemberSelected=new b.o,this.afterFamilyMemberRemove=new b.o}ngOnInit(){this.members||(this.members=[])}removeFamilyMember(e){this.afterFamilyMemberRemove.emit(e)}doesMemberExist(e){return null!=this.members.find(t=>t.id==e.id)}addMemberToFamily(e){this.doesMemberExist(e)||this.afterFamilyMemberSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(u.a))},e.\u0275cmp=b.Hb({type:e,selectors:[["family-members"]],inputs:{members:"members"},outputs:{afterFamilyMemberSelected:"afterFamilyMemberSelected",afterFamilyMemberRemove:"afterFamilyMemberRemove"},decls:3,vars:2,consts:[["labelColor","rgba(0,0,0,.54)","placeholder","Add to family",3,"clearAfterSelection","memberSelected"],[4,"ngFor","ngForOf"],["fxLayout","row",1,"family-member"],["fxFlex","180px","fxLayout","column","fxLayoutAlign","start",1,"family-member-row"],[1,"phone-number"],["mat-icon-button",""],[3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"div"),b.Tb(1,"app-find-member",0),b.bc("memberSelected",function(e){return t.addMemberToFamily(e)}),b.Sb(),b.Sb(),b.Dc(2,U,10,3,"ng-container",1)),2&e&&(b.Cb(1),b.mc("clearAfterSelection",!0),b.Cb(1),b.mc("ngForOf",t.members))},directives:[G.a,c.m,f.c,f.a,f.b,h.b,p.a],styles:[".phone-number[_ngcontent-%COMP%]{font-size:10px;color:rgba(0,0,0,.54)}.family-member-row[_ngcontent-%COMP%]{margin-top:10px}"]}),e})();var Q=n("vkho");let X=(()=>{class e{constructor(e,t){this.dialog=e,this.purchase=t}ngOnInit(){}toggleFreeze(){const e=Object.assign({},this.purchase);e.isFreezed=!e.isFreezed,this.dialog.close(e)}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(l.g),b.Nb(l.a))},e.\u0275cmp=b.Hb({type:e,selectors:[["app-freeze-membership-dialog"]],decls:7,vars:2,consts:[["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"div",0),b.Ec(1),b.Sb(),b.Tb(2,"div",1),b.Tb(3,"button",2),b.Ec(4,"No"),b.Sb(),b.Tb(5,"button",3),b.bc("click",function(){return t.toggleFreeze()}),b.Ec(6,"Yes"),b.Sb(),b.Sb()),2&e&&(b.Cb(1),b.Hc("Do you want to ",t.purchase.isFreezed?"defreeze":"freeze"," ",t.purchase.item.name," ? "))},directives:[l.e,l.c,h.b,l.d],styles:[""]}),e})();var V=n("9dXC"),q=n("LRne"),K=n("bOdf"),J=n("lJxs"),Y=n("itXk"),B=n("znSr"),W=n("Qu3c"),Z=n("1ybu");function ee(e,t){if(1&e&&(b.Tb(0,"div",24),b.Ec(1,"! "),b.Sb()),2&e){const e=b.fc().$implicit;b.mc("matTooltip",e.item.name+" is almost expired!")}}function te(e,t){if(1&e){const e=b.Ub();b.Tb(0,"mat-icon",25),b.bc("click",function(){b.xc(e);const t=b.fc().$implicit;return b.fc().freezePurchase(t)}),b.Ec(1,"ac_unit "),b.Sb()}}const ne=function(e,t,n){return{freezed:e,expired:t,"nearly-expiration":n}};function ce(e,t){if(1&e&&(b.Tb(0,"div",13),b.Dc(1,ee,2,1,"div",14),b.Tb(2,"div",15),b.Ec(3),b.Sb(),b.Tb(4,"div",16),b.Ec(5),b.gc(6,"date"),b.Sb(),b.Tb(7,"div",17),b.Ec(8),b.gc(9,"date"),b.Sb(),b.Tb(10,"div",18),b.Ec(11),b.gc(12,"membershipExpiration"),b.Sb(),b.Tb(13,"div",19),b.Ec(14),b.gc(15,"currency"),b.Sb(),b.Tb(16,"div",20),b.Tb(17,"mat-icon",21),b.Ec(18,"note_alt"),b.Sb(),b.Sb(),b.Tb(19,"div",22),b.Dc(20,te,2,0,"mat-icon",23),b.Sb(),b.Sb()),2&e){const e=t.$implicit;b.mc("ngClass",b.rc(19,ne,e.isFreezed,e.isExpired,e.isNearlyExpire)),b.Cb(1),b.mc("ngIf",e.isNearlyExpire),b.Cb(2),b.Fc(e.item.name),b.Cb(2),b.Fc(b.hc(6,9,e.saleDate)),b.Cb(3),b.Fc(b.hc(9,11,e.startDate)),b.Cb(3),b.Fc(b.ic(12,13,e.item,e.startDate)),b.Cb(3),b.Fc(b.ic(15,16,e.price,"AED")),b.Cb(3),b.mc("matTooltip",e.note),b.Cb(3),b.mc("ngIf",!e.isExpired||e.isExpired&&e.isFreezed)}}const oe=j;let re=(()=>{class e{constructor(e,t){this.dialog=e,this.communicationService=t,this.purchasesSubj=new a.a(null),this.todayMoment=oe().startOf("day")}ngOnInit(){this.communicationService.getMemberPurchases(this.memberId).pipe(Object(K.a)(e=>Object(q.a)(...e)),Object(J.a)((e,t)=>Object(q.a)(Object(Q.a)(Object.assign({},e),this.todayMoment)))).pipe(e=>e.lift(new Y.a(void 0))).subscribe(e=>{this.purchasesSubj.next(e)})}addNewPurchase(){this.dialog.open(V.a,{data:this.memberId}).afterClosed().subscribe(e=>{e&&this.communicationService.savePurchase(e).toPromise().then(e=>{this.purchasesSubj.next([Object(Q.a)(e,this.todayMoment),...this.purchasesSubj.getValue()])})})}freezePurchase(e){this.dialog.open(X,{data:e}).afterClosed().subscribe(t=>{if(t){e.isFreezed=t.isFreezed;const n=oe.now();new Promise((c,o)=>{t.isFreezed?c({id:0,startDate:n,purchaseId:t.id}):this.communicationService.findFreeze(e.id,t.lastFreezeTs).toPromise().then(e=>c(e))}).then(t=>{0==t.id?e.lastFreezeTs=n:t.endDate=n;const c=this.communicationService.freezeMembership(t).toPromise(),o=this.communicationService.savePurchase(e).toPromise();Promise.all([c,o]).then(()=>{this.purchasesSubj.next([...this.purchasesSubj.getValue()])})})}})}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(l.b),b.Nb(u.a))},e.\u0275cmp=b.Hb({type:e,selectors:[["app-purchase-history"]],inputs:{memberId:"memberId"},decls:22,vars:3,consts:[["fxLayout","column","fxFill","",1,"purchase-history-container"],["fxLayout","column",1,"member-purchases"],["fxLayoutAlign","start center",1,"h2","primal-title"],["fxLayout","row",1,"purchase-column-header"],[1,"purchase-column","column-header","column-name"],[1,"purchase-column","column-header","column-sale-date"],[1,"purchase-column","column-header","column-start-date"],[1,"purchase-column","column-header","column-expiry-date"],[1,"purchase-column","column-header","column-price"],[1,"purchase-column","column-header","column-note"],[1,"purchase-column","column-header","column-freeze"],["class","purchase-row","fxLayout","row",3,"ngClass",4,"ngFor","ngForOf"],["id","sell-icon","mat-fab","","color","primary",3,"click"],["fxLayout","row",1,"purchase-row",3,"ngClass"],["class","nearly-expired-exclamation",3,"matTooltip",4,"ngIf"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-name"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-sale-date"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-start-date"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-expiry-date"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-price"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-note"],[3,"matTooltip"],["fxLayoutAlign","start center",1,"purchase-column","column-body","column-freeze"],[3,"click",4,"ngIf"],[1,"nearly-expired-exclamation",3,"matTooltip"],[3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"div",0),b.Tb(1,"div",1),b.Tb(2,"h2",2),b.Ec(3,"Purchase History "),b.Sb(),b.Tb(4,"div",3),b.Tb(5,"div",4),b.Ec(6,"Item name"),b.Sb(),b.Tb(7,"div",5),b.Ec(8,"Sale Date"),b.Sb(),b.Tb(9,"div",6),b.Ec(10,"Start Date"),b.Sb(),b.Tb(11,"div",7),b.Ec(12,"Expiry Date"),b.Sb(),b.Tb(13,"div",8),b.Ec(14,"Price"),b.Sb(),b.Ob(15,"div",9),b.Ob(16,"div",10),b.Sb(),b.Dc(17,ce,21,23,"div",11),b.gc(18,"async"),b.Sb(),b.Tb(19,"button",12),b.bc("click",function(){return t.addNewPurchase()}),b.Tb(20,"mat-icon"),b.Ec(21,"attach_money"),b.Sb(),b.Sb(),b.Sb()),2&e&&(b.Cb(17),b.mc("ngForOf",b.hc(18,1,t.purchasesSubj)))},directives:[f.c,f.e,f.b,c.m,h.b,p.a,c.l,B.a,c.n,W.a],pipes:[c.b,c.f,Z.a,c.d],styles:[".member-purchases[_ngcontent-%COMP%]{width:100%}.member-purchases[_ngcontent-%COMP%]   .column-header[_ngcontent-%COMP%]{font-weight:700;color:rgba(0,0,0,.54);margin:10px 0}.member-purchases[_ngcontent-%COMP%]   .purchase-column[_ngcontent-%COMP%]{padding:10px 0;border-bottom:1px solid rgba(0,0,0,.12)}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-name[_ngcontent-%COMP%]{width:40%;padding-left:20px}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-expiry-date[_ngcontent-%COMP%], .member-purchases[_ngcontent-%COMP%]   .purchase-column.column-sale-date[_ngcontent-%COMP%], .member-purchases[_ngcontent-%COMP%]   .purchase-column.column-start-date[_ngcontent-%COMP%]{width:15%}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-price[_ngcontent-%COMP%]{width:10%}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-note[_ngcontent-%COMP%]{width:24px;cursor:context-menu}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-freeze[_ngcontent-%COMP%]{width:24px;cursor:pointer}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-discount[_ngcontent-%COMP%]{width:5%;min-width:60px}.member-purchases[_ngcontent-%COMP%]   .purchase-column.column-total[_ngcontent-%COMP%]{width:10%}.member-purchases[_ngcontent-%COMP%]   .purchase-row[_ngcontent-%COMP%]{position:relative}.member-purchases[_ngcontent-%COMP%]   .purchase-row.freezed[_ngcontent-%COMP%]{background-color:rgba(0,117,169,.1)}.member-purchases[_ngcontent-%COMP%]   .purchase-row.freezed[_ngcontent-%COMP%]   .column-freeze[_ngcontent-%COMP%]{color:rgba(0,117,169,.6)}.member-purchases[_ngcontent-%COMP%]   .purchase-row[_ngcontent-%COMP%]   .nearly-expired-exclamation[_ngcontent-%COMP%]{position:absolute;left:5px;font-size:20px;height:45px;color:red;line-height:45px}.member-purchases[_ngcontent-%COMP%]   .purchase-row.expired[_ngcontent-%COMP%]{opacity:.6}#sell-icon[_ngcontent-%COMP%]{margin-top:15px;margin-bottom:15px;place-self:flex-end}"],changeDetection:0}),e})();function ie(e,t){if(1&e){const e=b.Ub();b.Tb(0,"div",20),b.Tb(1,"button",21),b.bc("click",function(){return b.xc(e),b.fc(2).updateMember()}),b.Tb(2,"mat-icon"),b.Ec(3,"edit"),b.Sb(),b.Sb(),b.Sb()}}function ae(e,t){if(1&e){const e=b.Ub();b.Tb(0,"div",1),b.Tb(1,"h1"),b.Ec(2),b.Sb(),b.Tb(3,"form",2),b.Tb(4,"div",3),b.Ob(5,"img",4),b.Sb(),b.Tb(6,"div",5),b.Tb(7,"div",6),b.Tb(8,"div",7),b.Tb(9,"div",8),b.Tb(10,"mat-form-field"),b.Ob(11,"input",9),b.Sb(),b.Sb(),b.Tb(12,"div",8),b.Tb(13,"mat-form-field"),b.Ob(14,"input",10),b.Sb(),b.Sb(),b.Tb(15,"div",8),b.Tb(16,"mat-form-field"),b.Ob(17,"input",11),b.Sb(),b.Sb(),b.Tb(18,"div",12),b.Tb(19,"mat-form-field"),b.Ob(20,"input",13),b.Sb(),b.Sb(),b.Sb(),b.Tb(21,"div",7),b.Tb(22,"div",8),b.Tb(23,"mat-form-field"),b.Ob(24,"input",14),b.Sb(),b.Sb(),b.Tb(25,"div",12),b.Tb(26,"mat-form-field"),b.Tb(27,"textarea",15),b.Ec(28,"            "),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Tb(29,"div",7),b.Tb(30,"div",8),b.Tb(31,"family-members",16),b.bc("afterFamilyMemberRemove",function(t){return b.xc(e),b.fc().removeFamilyMember(t)})("afterFamilyMemberSelected",function(t){return b.xc(e),b.fc().addMemberToFamily(t)}),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Dc(32,ie,4,0,"div",17),b.Sb(),b.Tb(33,"div",18),b.Ob(34,"app-purchase-history",19),b.Sb(),b.Sb()}if(2&e){const e=b.fc();b.Cb(2),b.Gc("Profile of ",e.form.value.firstName+" "+e.form.value.lastName,""),b.Cb(1),b.mc("formGroup",e.form),b.Cb(2),b.mc("src",e.loadedMember.photoLink,b.yc),b.Cb(26),b.mc("members",e.loadedMember.family),b.Cb(1),b.mc("ngIf",e.form.touched),b.Cb(2),b.mc("memberId",e.loadedMember.id)}}const me=[{path:"",component:z},{path:":id",component:(()=>{class e{constructor(e,t,n,c,o){this.dialog=e,this.fb=t,this.communicationService=n,this.activatedRoute=c,this.cd=o}checkChangesAndNotifyUser(e){this.form.touched&&(e.returnValue="You made a changes, but didn't save them")}ngOnInit(){const e=parseInt(this.activatedRoute.snapshot.params.id,10);this.loadProfile(e),this.routeChangeSub=this.activatedRoute.url.subscribe(e=>this.loadProfile(parseInt(Object(A.first)(e).path,10)))}initForm(){return this.fb.group({firstName:new L.g(this.loadedMember.firstName,L.v.required),lastName:new L.g(this.loadedMember.lastName,L.v.required),notes:new L.g(this.loadedMember.notes),referalType:new L.g(this.loadedMember.referalType),email:new L.g(this.loadedMember.email,L.v.email),phoneNumber:new L.g(this.loadedMember.phoneNumber,L.v.required)})}loadProfile(e){this.communicationService.getMember(e.toString()).toPromise().then(e=>{this.loadedMember=e,this.form=this.initForm(),this.cd.markForCheck()})}ngOnDestroy(){this.routeChangeSub.unsubscribe()}patchFamilyField(){this.loadedMember.family||(this.loadedMember.family=[])}updateMember(){this.form.valid&&(this.loadedMember=Object.assign(this.loadedMember,this.form.value),this.communicationService.updateMember(this.loadedMember),this.form=this.initForm(),this.cd.markForCheck())}removeFamilyMember(e){this.patchFamilyField();const t=this.loadedMember.family.findIndex(t=>t.id==e.id);this.loadedMember.family.splice(t,1),this.form.markAllAsTouched()}addMemberToFamily(e){e.id!=this.loadedMember.id&&(this.patchFamilyField(),this.loadedMember.family.push(e),this.communicationService.updateMember(this.loadedMember),this.form.markAllAsTouched())}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(l.b),b.Nb(L.f),b.Nb(u.a),b.Nb(o.a),b.Nb(b.h))},e.\u0275cmp=b.Hb({type:e,selectors:[["app-member-profile"]],hostBindings:function(e,t){1&e&&b.bc("beforeunload",function(e){return t.checkChangesAndNotifyUser(e)},!1,b.wc)},decls:1,vars:1,consts:[["fxLayout","column","fxFlex","","fxLayoutAlign","start","class","member-profile-container",4,"ngIf"],["fxLayout","column","fxFlex","","fxLayoutAlign","start",1,"member-profile-container"],["fxLayout","row",1,"member",3,"formGroup"],[1,"member-photo"],["height","250",3,"src"],[1,"member-info-right-part"],["fxLayout","row",1,"member-info"],["fxFlex","33"],[1,"member-info-row"],["placeholder","First name","matInput","","formControlName","firstName"],["placeholder","Last name","matInput","","formControlName","lastName"],["placeholder","Email","matInput","","formControlName","email"],["fxLayout","row",1,"member-info-row"],["matInput","","placeholder","Phone number","formControlName","phoneNumber"],["matInput","","placeholder","Referal type","formControlName","referalType"],["matInput","","placeholder","Notes","formControlName","notes","matInput",""],[3,"members","afterFamilyMemberRemove","afterFamilyMemberSelected"],["fxLayoutAlign","start end",4,"ngIf"],["fxLayoutAlign","start"],[3,"memberId"],["fxLayoutAlign","start end"],["mat-mini-fab","",3,"click"]],template:function(e,t){1&e&&b.Dc(0,ae,35,6,"div",0),2&e&&b.mc("ngIf",t.form)},directives:[c.n,f.c,f.a,f.b,L.w,L.q,L.j,R.c,$.b,L.c,L.p,L.i,H,re,h.b,p.a],styles:["h2[_ngcontent-%COMP%]{margin-bottom:15px;margin-top:15px}.member-profile-container[_ngcontent-%COMP%]{position:relative}.member-profile-container[_ngcontent-%COMP%]   .member-photo[_ngcontent-%COMP%]{margin-right:20px}.member-profile-container[_ngcontent-%COMP%]   .member-info[_ngcontent-%COMP%]   .member-info-row[_ngcontent-%COMP%]{margin:10px 0}.member-profile-container[_ngcontent-%COMP%]   .member-info[_ngcontent-%COMP%]   .member-info-row[_ngcontent-%COMP%]   .member-info-label[_ngcontent-%COMP%]{color:rgba(0,0,0,.54);margin-right:10px;font-weight:700}.member-profile-container[_ngcontent-%COMP%]   .member-info-right-part[_ngcontent-%COMP%]{width:60%}.member-profile-container[_ngcontent-%COMP%]   app-purchase-history[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e})()}];let se=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.Lb({type:e}),e.\u0275inj=b.Kb({imports:[[o.f.forChild(me)],o.f]}),e})();var be=n("PCNd");let le=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.Lb({type:e}),e.\u0275inj=b.Kb({providers:[],imports:[[c.c,se,be.a]]}),e})()}}]);