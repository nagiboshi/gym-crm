(self.webpackChunkclub_membership_crm=self.webpackChunkclub_membership_crm||[]).push([[556],{5556:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SalesModule:()=>B});var i=n(1116),o=n(3464),r=n(5366),a=n(7173),s=n(2935),l=n(1041),m=n(9752),c=n(5965),u=n(3070),d=n(9550),p=n(4369),g=n(994),h=n(3841),f=n(7064),Z=n(7307);function b(e,t){1&e&&(r.TgZ(0,"h6",11),r._uU(1,"*You have unsaved changes"),r.qZA())}function _(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.ynx(1,12),r.TgZ(2,"div",13),r.TgZ(3,"mat-form-field",14),r._UZ(4,"input",15),r.qZA(),r.qZA(),r.TgZ(5,"div",16),r._UZ(6,"mat-checkbox",17),r.qZA(),r.TgZ(7,"div",13),r.TgZ(8,"mat-form-field",18),r._UZ(9,"input",19),r.qZA(),r.qZA(),r.TgZ(10,"div",13),r.TgZ(11,"mat-form-field",20),r.TgZ(12,"mat-select",21),r.TgZ(13,"mat-option",22),r._uU(14,"Day"),r.qZA(),r.TgZ(15,"mat-option",23),r._uU(16,"Month"),r.qZA(),r.TgZ(17,"mat-option",24),r._uU(18,"Year"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(19,"div",13),r.TgZ(20,"mat-form-field",25),r._UZ(21,"input",26),r.qZA(),r.qZA(),r.TgZ(22,"div",27),r.NdJ("click",function(){const t=r.CHM(e).index,n=r.oxw();return n.showDeletePrompt(t,n.membershipsArray.controls[t].value)}),r.TgZ(23,"mat-icon"),r._uU(24,"delete"),r.qZA(),r.qZA(),r.BQk(),r.BQk()}if(2&e){const e=t.index,n=r.oxw();r.xp6(1),r.Q6J("formGroupName",e),r.xp6(7),r.Udp("visibility",n.membershipsArray.controls[e].value.isShared?"visible":"hidden")}}let v=(()=>{class e{constructor(e,t,n,i){this.membershipGroup=e,this.fb=t,this.dialogRef=n,this.dialog=i,this.membershipsArray=new l.Oe([]),e.memberships.forEach(e=>{this.membershipsArray.push(this.newMembershipFormGroup(e))}),this.formGroup=t.group({id:this.membershipGroup.id,name:[this.membershipGroup.name,l.kI.required],memberships:this.membershipsArray})}newMembershipFormGroup(e){var t,n,i;return this.fb.group({id:[null!==(t=null==e?void 0:e.id)&&void 0!==t?t:0],name:[null==e?void 0:e.name,[l.kI.required]],isShared:[null!==(n=null==e?void 0:e.isShared)&&void 0!==n&&n],numberOfParticipants:[null!==(i=null==e?void 0:e.numberOfParticipants)&&void 0!==i?i:1,[l.kI.required]],expirationType:[null==e?void 0:e.expirationType,l.kI.required],expirationLength:[null==e?void 0:e.expirationLength,l.kI.required]})}submit(){this.dialogRef.close(this.formGroup.value)}ngOnInit(){}showDeletePrompt(e,t){this.dialog.open(m.X,{data:`Are you sure you want to remove membership ${t.name} ?`}).afterClosed().subscribe(t=>{t&&(this.membershipsArray.removeAt(e),this.formGroup.markAsDirty())})}addMembership(){this.membershipsArray.push(this.newMembershipFormGroup())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.WI),r.Y36(l.qu),r.Y36(s.so),r.Y36(s.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["membership-crud-dialog"]],decls:25,vars:4,consts:[[3,"formGroup","ngSubmit"],["fxLayout","column",1,"sales-dialog"],["class","unsaved-changes",4,"ngIf"],["matInput","","formControlName","name","placeholder","Name"],["formArrayName","memberships"],[1,"sales-grid"],[1,"sales-grid-header"],[4,"ngFor","ngForOf"],["mat-dialog-close","","mat-button",""],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["type","button","mat-raised-button","",3,"click"],[1,"unsaved-changes"],[3,"formGroupName"],[1,"sales-grid-body"],[1,"package-variation-name"],["formControlName","name","matInput",""],[1,"sales-grid-body","is-shared"],["formControlName","isShared"],[1,"number-of-participants"],["min","1","type","number","formControlName","numberOfParticipants","matInput",""],[1,"expiration-type"],["formControlName","expirationType"],["value","day"],["value","month"],["value","year"],[1,"expiration-length"],["min","1","formControlName","expirationLength","type","number","matInput",""],[1,"sales-grid-body","remove",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.NdJ("ngSubmit",function(){return t.submit()}),r.TgZ(1,"mat-dialog-content",1),r.YNc(2,b,2,0,"h6",2),r.TgZ(3,"mat-form-field"),r._UZ(4,"input",3),r.qZA(),r.ynx(5,4),r.TgZ(6,"div",5),r.TgZ(7,"div",6),r._uU(8,"Name"),r.qZA(),r.TgZ(9,"div",6),r._uU(10,"Is Shared ?"),r.qZA(),r.TgZ(11,"div",6),r._uU(12,"Size"),r.qZA(),r.TgZ(13,"div",6),r._uU(14,"Expiration"),r.qZA(),r._UZ(15,"div",6),r._UZ(16,"div",6),r.YNc(17,_,25,3,"ng-container",7),r.qZA(),r.BQk(),r.qZA(),r.TgZ(18,"mat-dialog-actions"),r.TgZ(19,"button",8),r._uU(20,"Cancel"),r.qZA(),r.TgZ(21,"button",9),r._uU(22,"Save"),r.qZA(),r.TgZ(23,"button",10),r.NdJ("click",function(){return t.addMembership()}),r._uU(24,"Add Membership"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("formGroup",t.formGroup),r.xp6(2),r.Q6J("ngIf",t.formGroup.dirty),r.xp6(15),r.Q6J("ngForOf",t.membershipsArray.controls),r.xp6(4),r.Q6J("disabled",t.formGroup.invalid))},directives:[l._Y,l.JL,l.sg,s.xY,c.xw,i.O5,u.KE,d.Nt,l.Fj,l.JJ,l.u,l.CE,i.sg,s.H8,p.lW,s.ZT,l.x0,g.oG,l.qQ,l.wV,h.gD,f.ey,Z.Hw],styles:[".sales-dialog[_ngcontent-%COMP%]{min-width:550px;position:relative}.sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]{display:inline-grid;grid-template-columns:auto auto auto auto auto auto;grid-column-gap:20px}.sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]   .is-shared[_ngcontent-%COMP%]{justify-self:center;align-self:center}.sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{align-self:center;cursor:pointer}.sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]   .sales-grid-header[_ngcontent-%COMP%]{color:rgba(0,0,0,.7);font-size:.8em}.sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]   .expiration-type[_ngcontent-%COMP%]{width:70px}.sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]   .expiration-length[_ngcontent-%COMP%], .sales-dialog[_ngcontent-%COMP%]   .sales-grid[_ngcontent-%COMP%]   .number-of-participants[_ngcontent-%COMP%]{width:40px}.sales-dialog[_ngcontent-%COMP%]   .unsaved-changes[_ngcontent-%COMP%]{color:red;text-align:right;margin:0;position:absolute;right:23px}"]}),e})();var A=n(9199),C=n(5609),y=n(1441),x=n(9241);function w(e,t){1&e&&(r.TgZ(0,"th",17),r._uU(1,"Membership list"),r.qZA())}function M(e,t){if(1&e&&(r.TgZ(0,"td",18),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.hij(" ",e.name," ")}}function q(e,t){1&e&&r._UZ(0,"th",17)}function T(e,t){1&e&&r._UZ(0,"td",19)}function O(e,t){1&e&&r._UZ(0,"th",17)}function P(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"td",19),r.TgZ(1,"mat-icon",20),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().openSalesDialog(t)}),r._uU(2,"edit"),r.qZA(),r.qZA()}}function U(e,t){1&e&&r._UZ(0,"th",21)}function N(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"td",22),r.TgZ(1,"mat-icon",20),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().openDeletePromptDialog(t)}),r._uU(2,"delete"),r.qZA(),r.qZA()}}function S(e,t){1&e&&r._UZ(0,"tr",23)}function k(e,t){1&e&&r._UZ(0,"tr",24)}function D(e,t){1&e&&(r.TgZ(0,"tr",25),r.TgZ(1,"td",26),r._uU(2,"No memberships created yet"),r.qZA(),r.qZA())}const G=function(){return[5]};let Y=(()=>{class e{constructor(e,t){this.membershipGroupService=e,this.dialog=t,this.columns=["name","items","edit","delete"]}_newMembershipGroup(){return{memberships:[],id:0,name:""}}openSalesDialog(e){const t=e||this._newMembershipGroup();this.dialog.open(v,{data:t}).afterClosed().subscribe(e=>{e&&this.membershipGroupService.saveMembershipGroup(e)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.dataSource=new A.by([]),this.packageUpdateSub=this.membershipGroupService.getMembershipGroups$().subscribe(e=>this.dataSource.data=e)}openDeletePromptDialog(e){this.dialog.open(m.X,{data:`Are you sure you want to delete ${e.name} ?`}).afterClosed().subscribe(()=>{this.membershipGroupService.removeMembershipGroup(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.s),r.Y36(s.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["membership-list"]],viewQuery:function(e,t){if(1&e&&r.Gf(C.NW,5),2&e){let e;r.iGM(e=r.CRH())&&(t.paginator=e.first)}},decls:22,vars:6,consts:[["fxLayout","column","fxLayoutAlign","space-between",1,"membership-settings-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","items"],["class","edit-cell","mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["matColumnDef","delete"],["mat-header-cell","",4,"matHeaderCellDef"],["class","delete-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["fxLayoutAlign","space-between center"],["showFirstLastButtons","",3,"hidePageSize","pageSizeOptions"],["mat-mini-fab","",1,"add-button",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"edit-cell"],[3,"click"],["mat-header-cell",""],["mat-cell","",1,"delete-cell"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","3",1,"mat-cell"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"table",1),r.ynx(2,2),r.YNc(3,w,2,0,"th",3),r.YNc(4,M,2,1,"td",4),r.BQk(),r.ynx(5,5),r.YNc(6,q,1,0,"th",3),r.YNc(7,T,1,0,"td",6),r.BQk(),r.ynx(8,7),r.YNc(9,O,1,0,"th",3),r.YNc(10,P,3,0,"td",6),r.BQk(),r.ynx(11,8),r.YNc(12,U,1,0,"th",9),r.YNc(13,N,3,0,"td",10),r.BQk(),r.YNc(14,S,1,0,"tr",11),r.YNc(15,k,1,0,"tr",12),r.YNc(16,D,3,0,"tr",13),r.qZA(),r.TgZ(17,"div",14),r._UZ(18,"mat-paginator",15),r.TgZ(19,"button",16),r.NdJ("click",function(){return t.openSalesDialog()}),r.TgZ(20,"mat-icon"),r._uU(21,"add "),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("dataSource",t.dataSource),r.xp6(13),r.Q6J("matHeaderRowDef",t.columns),r.xp6(1),r.Q6J("matRowDefColumns",t.columns),r.xp6(3),r.Q6J("hidePageSize",!0)("pageSizeOptions",r.DdM(5,G)))},directives:[c.xw,c.Wh,A.BZ,x.YE,A.w1,A.fO,A.Dz,A.as,A.nj,A.Ee,C.NW,p.lW,Z.Hw,A.ge,x.nU,A.ev,A.XQ,A.Gk],styles:[".delete-cell[_ngcontent-%COMP%], .edit-cell[_ngcontent-%COMP%]{width:30px;cursor:pointer;text-align:center}.delete-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .edit-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0;min-width:35px;max-width:35px}table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   .table-header-title[_ngcontent-%COMP%]{margin-right:20px}.membership-settings-container[_ngcontent-%COMP%]{height:353px}"]}),e})();const J=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["sales"]],decls:4,vars:0,consts:[["label","Stocks"],["label","Memberships"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-tab-group"),r._UZ(1,"mat-tab",0),r.TgZ(2,"mat-tab",1),r._UZ(3,"membership-list"),r.qZA(),r.qZA())},directives:[a.SP,a.uX,Y],styles:[""]}),e})()}];let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[o.Bz.forChild(J)],o.Bz]}),e})();var I=n(8030);let B=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[i.ez,Q,I.m]]}),e})()}}]);